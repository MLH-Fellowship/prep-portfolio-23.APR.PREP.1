<div id="map">

</div>


<script>
    var fellows_information = {{ site.data.fellows_information | jsonify }};

    const mymap = L.map('map').setView([51.505, -0.09], 2);

    var tiles = L.esri.basemapLayer("Streets").addTo(mymap);

    // create the geocoding control and add it to the map
    var searchControl = L.esri.Geocoding.geosearch({
    providers: [
        L.esri.Geocoding.arcgisOnlineProvider({
        // API Key to be passed to the ArcGIS Online Geocoding Service
        apikey: 'YOUR API KEY'
        })
    ]
    }).addTo(mymap);

    // create an empty layer group to store the results and add it to the map
    var results = L.layerGroup().addTo(mymap);

    // for each of the fellow's location add that location to the map as a marker
    for (var i = 0; i < fellows_information.length - 1; i++) {
        (function (index) {
            // converts the location string into a dictionary of lists of dictionaries that contains the latlng 
            L.esri.Geocoding.geocode({apikey: 'YOUR API KEY'}).text(fellows_information[i]['location']).run(function (err, response) {
                if (err) {
                    console.log(err);
                    return;
                }

                marker = L.marker(response['results'][0]['latlng']);

               //popup for each marker containing the fellows information in cards such as their name, location, and description.
                marker.bindPopup(`<div class="popup-content">
               
                    <img src="/assets/img/${fellows_information[index]['name']}.jpg" />
                    <h5>${fellows_information[index]['name']}</h5>
                    <p>${fellows_information[index]['location']}</p>
                    <p>${fellows_information[index]['description']}</p></div>`, { className: 'popup-style' });

            
                results.addLayer(marker)
            });
         })(i);
    }
    
</script>





